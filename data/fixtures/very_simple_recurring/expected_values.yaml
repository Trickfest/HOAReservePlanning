scenario: very_simple_recurring
expect:
  validation:
    errors: []
    warnings: []
  workbook:
    values:
    - sheet: Forecast
      cell: C2
      equals: 100000
    formulas:
    - sheet: Forecast
      cell: B2
      equals: =Inputs!$B$3
    - sheet: Forecast
      cell: D2
      equals: =C2
    - sheet: Forecast
      cell: D3
      equals: =D2+C3
    - sheet: Forecast
      cell: F2
      equals: =E2
    - sheet: Forecast
      cell: F3
      equals: =F2+E3
    - sheet: Forecast
      cell: G2
      equals: =SUMIFS(Schedule!$D$2:$D$21,Schedule!$A$2:$A$21,A2)
    - sheet: Forecast
      cell: I2
      equals: =IF(SUM(Funding!$C$2:$C$11)=0,"",B2/(SUM(Funding!$C$2:$C$11)))
    - sheet: Forecast
      cell: J2
      equals: =IF(SUM(G2:INDEX($G$2:$G$12,MIN(2+4,12)-1))=0,"",B2/SUM(G2:INDEX($G$2:$G$12,MIN(2+4,12)-1)))
    - sheet: Schedule
      cell: D2
      equals: =Components!$D$2*(1+Inputs!$B$4)^(A2-Inputs!$B$2+1)
    - sheet: Dashboard
      cell: B4
      equals: =Forecast!$A$12
  model:
    schedule:
    - year: 2036
      component_id: roof
      nominal_expense: 1000000
    forecast:
    - year: 2026
      end_balance: 100000
    - year: 2036
      end_balance: 100000
    counts:
      schedule_items: 1
      negative_balance_years: 0
      zero_expense_years: 10
      forecast_years: 11
