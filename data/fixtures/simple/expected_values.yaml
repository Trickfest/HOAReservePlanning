scenario: simple
expect:
  validation:
    errors: []
    warnings: []
  workbook:
    values:
    - sheet: Forecast
      cell: C2
      equals: 300
    formulas:
    - sheet: Forecast
      cell: B2
      equals: =Inputs!$B$3
    - sheet: Schedule
      cell: D2
      equals: =Components!$D$2*(1+Inputs!$B$4)^(A2-Inputs!$B$2+1)
    - sheet: Dashboard
      cell: B4
      equals: =Forecast!$A$6
    - sheet: Forecast
      cell: G2
      equals: =SUMIFS(Schedule!$D$2:$D$201,Schedule!$A$2:$A$201,A2)
    - sheet: Forecast
      cell: D2
      equals: =C2
    - sheet: Forecast
      cell: F2
      equals: =E2
    - sheet: Forecast
      cell: I2
      equals: =IF(SUM(Funding!$C$2:$C$51)=0,"",B2/(SUM(Funding!$C$2:$C$51)))
    - sheet: Forecast
      cell: J2
      equals: =IF(SUM(G2:INDEX($G$2:$G$6,MIN(2+4,6)-1))=0,"",B2/SUM(G2:INDEX($G$2:$G$6,MIN(2+4,6)-1)))
    - sheet: Forecast
      cell: D3
      equals: =D2+C3
    - sheet: Forecast
      cell: F3
      equals: =F2+E3
    - sheet: Funding
      cell: C2
      equals: =IF(Components!$A2="",0,IF(Components!$H2<>"Y",0,Components!$D2*(1+Inputs!$B$4)^(C$1-Inputs!$B$2+1)*IF(Components!$F2="Y",IF(Components!$G2<=0,0,IF(IF(Components!$G2<=0,0,IF((C$1-Components!$E2)>=0,IF(MOD((C$1-Components!$E2),Components!$G2)=0,Components!$G2,MOD((C$1-Components!$E2),Components!$G2)),Components!$G2+(C$1-Components!$E2)))<=0,0,(IF(Components!$G2<=0,0,IF((C$1-Components!$E2)>=0,IF(MOD((C$1-Components!$E2),Components!$G2)=0,Components!$G2,MOD((C$1-Components!$E2),Components!$G2)),Components!$G2+(C$1-Components!$E2))))/Components!$G2)),IF(C$1>Components!$E2,0,IF(Components!$E2-Inputs!$B$2<=0,1,(C$1-Inputs!$B$2)/(Components!$E2-Inputs!$B$2))))))
    - sheet: Funding
      cell: C3
      equals: =IF(Components!$A3="",0,IF(Components!$H3<>"Y",0,Components!$D3*(1+Inputs!$B$4)^(C$1-Inputs!$B$2+1)*IF(Components!$F3="Y",IF(Components!$G3<=0,0,IF(IF(Components!$G3<=0,0,IF((C$1-Components!$E3)>=0,IF(MOD((C$1-Components!$E3),Components!$G3)=0,Components!$G3,MOD((C$1-Components!$E3),Components!$G3)),Components!$G3+(C$1-Components!$E3)))<=0,0,(IF(Components!$G3<=0,0,IF((C$1-Components!$E3)>=0,IF(MOD((C$1-Components!$E3),Components!$G3)=0,Components!$G3,MOD((C$1-Components!$E3),Components!$G3)),Components!$G3+(C$1-Components!$E3))))/Components!$G3)),IF(C$1>Components!$E3,0,IF(Components!$E3-Inputs!$B$2<=0,1,(C$1-Inputs!$B$2)/(Components!$E3-Inputs!$B$2))))))
  model:
    schedule:
    - year: 2026
      component_id: paving_seal
      nominal_expense: 200
    - year: 2027
      component_id: entry_gate
      nominal_expense: 500
    - year: 2028
      component_id: paving_seal
      nominal_expense: 200
    forecast:
    - year: 2025
      end_balance: 1400
    - year: 2029
      end_balance: 2350.84
      tolerance: 0.01
    counts:
      schedule_items: 3
      negative_balance_years: 0
      zero_expense_years: 2
      forecast_years: 5
